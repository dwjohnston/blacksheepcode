---
meta:
  title: How to create a responsive React hook to listen for changes to cookies
  description: Your React components may wish to listen for changes to made to cookies, whether they were made by other React code, or HTTP requests or non-React JavaScript. The CookieStore API can help.
  dateCreated: 2024-10-02 18:00:00
series: 
  name: react_bits
  part: 1
  description: React bits

---

import {DemoFrame} from "@/components/DemoFrame/DemoFrame";
import {MyForm} from "@/components/demos/imperative_confirmation_modal/components/MyForm";

import {GithubPermalinkRsc, GithubIssueLinkRsc} from "react-github-permalink/dist/rsc";

Ever find your self writing code like this? 

```jsx
export function MyComponent() {

    const [modalIsOpen, setModalIsOpen] = useState(false); 
    const [formData, setFormData] = useState<null | FormData>(null);


    return <>

        <form 
            onSubmit={(e) => {
                e.preventDefault(); 
                setModalIsOpen(true); 
                setFormData(new FormData(e.currentTarget));
            }}
            >
             <button onClick ={() => setModalIsOpen(true)} type="submit">Submit</form> 
        </form>
        
        </>
        <Modal isOpen={modalIsOpen} onClose={setModalIsOpen(false)}>

                <button onClick={() => {
                    setFormData(null); 
                    setModalIsOpen(false);
                }}>Cancel</button>
                <button onClick={() => {
                    setModalIsOpen(false);
                    // Do whatever with the form data
                }}>Confirm</button>
        </Modal>
    </>
}
```

This is kind of gross right? 

This is where a pattern of encapsulating the open/closed state in a hook, and exposing just the needed parts to the calling components. 

Our form with confirmation required can now look like this: 

```jsx
    const [content, showConfirmation ] = useConfirmationModal({
        title: "Are you sure?", 
        body: "Some kind of custom text here", 
        cancelButton: "I am the customised cancel button", 
        confirmButton: "I am the confirm button",
    });


    return <>
        {content}
        <form 
            onSubmit={(e) => {
                e.preventDefault(); 
                
                // Calling the `showConfirmation` function will display the modal. 
                // If the modal is confirmed, then we trigger the callback passed in.
                showConfirmation(() => {
                    const formData = (e.currentTarget); 
                    //do whatever with the formData; 
                })
            }}
            >
             <button onClick ={() => setModalIsOpen(true)} type="submit">Submit</form> 
        </form>
        
        </>
```

This is nice right? 

Here's how we can implement such a hook: 

<>

<DemoFrame description={<>
    <p>Click the button to see the modal</p>
</>}>
      <MyForm/>
</DemoFrame>